# bump: rpm-version /RPM_VERSION="(.*)"/ gitrefs:https://github.com/rpm-software-management/rpm.git|re:/rpm-([\d.]+)-release/$1/|*
RPM_VERSION="6.0.0"

export ZOPEN_BUILD_LINE="STABLE"

export ZOPEN_STABLE_URL="https://github.com/rpm-software-management/rpm/releases/download/rpm-${RPM_VERSION}-release/rpm-${RPM_VERSION}.tar.bz2"  # Specify the stable build URL (either git or tarball)
export ZOPEN_STABLE_DEPS="bash coreutils zstd unzip git gawk patch grep sed file xz tar grep cpio libgpgerror zstd popt readline lua pkgconfig cmake zlib unzip libarchive scdoc libgcrypt openssl sqlite bzip2 gzip xz gettext make autoconf automake libtool perl m4 tar libiconv gpg doxygen lz4" # Specify the stable build dependencies.

export ZOPEN_EXTRA_CFLAGS="-D_POSIX_C_SOURCE=200809L" 
export ZOPEN_EXTRA_CPPFLAGS="-D_POSIX_C_SOURCE=200809L -D__XPLAT=1"  
export ZOPEN_SYSTEM_PREREQS="zos25"

export ZOPEN_CATEGORIES="core utilities"

export ZOPEN_SYSTEM_PREREQ=""

export ZOPEN_COMP="CLANG"
export ZOPEN_BOOTSTRAP="skip"  ## Bootstrap program to run (defaults to './bootstrap')
export ZOPEN_CONFIGURE="cmake" ## Configuration program to run (defaults to './configure')
export ZOPEN_INSTALL="skip"
export ZOPEN_CHECK="skip"

export ZOPEN_CONFIGURE_OPTS="-DZLIB_LIBRARY=\"\$ZLIB_HOME/lib/libz.a\" -DZLIB_INCLUDE_DIR=\"\$ZLIB_HOME/include\" -DLUA_DIR=\"\$LUA_HOME\" -DLUA_LIBRARIES=\"\$LUA_HOME/lib/liblua.a\" -DLUA_INCLUDE_DIR=\$LUA_HOME/include -DBZIP2_INCLUDE_DIR=\$BZIP2_HOME/include -DBZIP2_LIBRARIES=\$BZIP2_HOME/lib/libbz2.a -DLIBARCHIVE_DIR=\$LIBARCHIVE_HOME -DLIBARCHIVE_INCLUDE_DIR=\$LIBARCHIVE_HOME/include -DLIBARCHIVE_LIBRARY=\$LIBARCHIVE_HOME/lib/libarchive.a -DMAGIC_LIBRARY=\$FILE_HOME/lib/libmagic.a -DMAGIC_INCLUDE_DIR=\$FILE_HOME/include -DIntl_LIBRARY=\$GETTEXT_HOME/lib/libintl.a -DIntl_INCLUDE_DIR=\$GETTEXT_HOME/include/libintl.h -DWITH_READLINE=OFF -DWITH_LIBELF=OFF -DWITH_LIBDW=OFF -DWITH_LIBLZMA=OFF -DENABLE_OPENMP=OFF -DWITH_CAP=OFF -DWITH_ACL=OFF -DENABLE_PLUGINS=OFF -DWITH_AUDIT=OFF -DWITH_SELINUX=OFF -DWITH_SEQUOIA=OFF -DWITH_DBUS=OFF -DZSTD_INCLUDE_DIR=\"\${ZSTD_HOME}/include\" -DZSTD_LIBRARY=\"\${ZSTD_HOME}/lib\" -DHAVE_UNSHARE=OFF -DENABLE_PYTHON=OFF -DENABLE_CUTF8=OFF -DRPM_VENDOR=ibm -DIconv_INCLUDE_DIR=\$LIBICONV_HOME/include -DIconv_LIBRARY=\$LIBICONV_HOME/lib/libiconv.a -DENABLE_WERROR=OFF -DENABLE_ASAN=OFF -DENABLE_UBSAN=OFF -DENABLE_BDB_RO=OFF -DWITH_FSVERITY=OFF -DWITH_IMAEVM=OFF -DWITH_DOXYGEN=OFF -DENABLE_TESTSUITE=ON -DMKTREE_BACKEND=rootfs"
export ZOPEN_MAKE_OPTS="tree"

zopen_append_to_zoslib_env(){
cat <<EOF
RPM_CONFIGDIR|set|PROJECT_ROOT/lib/rpm
MAGIC|set|PROJECT_ROOT/../../file/file/share/misc/magic.mgc
EOF
}
